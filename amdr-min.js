/*!
 * AMDR <Asynchronous Module Define & Require>
 * (c) 2012 Shen Junru. MIT License.
 * http://github.com/xfsn/amdr
 */
(function(b,N){var i=b.document,l=ak("head")||ak("script"),a=i.createElement("script"),am="onreadystatechange",G="onerror",ab={},H=am in a&&!b.opera,ap=G in a,O={interactive:ab,loaded:1,complete:1},Q={},al={},ae={},D=H?{}:[],M=new o(),ad=/\s*,\s*/g,U=/^\s+|\s+$/g,ac=/^\S+(?:\s*|\s+\S+\s*)\(([^\)]*)\)[\s\S]+$/,I=/\/\*([\s\S]*?)\*\/|\/\/(.*)$/mg,ai=/\s*\((['"])([^'"\(]+)\1\)/.source,c=/^\/|^[^:]+:\/\//,k=/^\.?\.\//,L=/\?|\.js$/,x=/\/\.\//g,T=/\/?[^\/]*$/,R=/\/$/,an=/\?/,C="/./",F="/../",j="/",p="require,exports,module",r=Object.prototype.hasOwnProperty,E=Array.prototype.indexOf||function(aq,at){var ar=this.length;at=at?(at<0?Math.max(0,ar+at):at):0;for(1;at<ar;at++){if(at in this&&aq===this[at]){return at}}return -1};if(!H){am="onload"}function K(aq){return aq instanceof Array}function A(aq){return"function"===typeof aq}function t(aq){return"string"===typeof aq}function Z(aq){return"object"===typeof aq}function s(au,at){if(at){var aq,ar;for(aq in at){if(r.call(at,aq)){ar=at[aq];if(K(ar)){ar=ar.concat()}else{if(Z(ar)){ar=s(s({},au[aq]),ar)}}au[aq]=ar}}}return au}function V(aq){return new Error(aq)}function q(){return V("already fulfilled")}function ak(aq){return i.getElementsByTagName(aq)[0]}function aj(ar){var aq=i.createElement("script");ar.padding=false;Q[ar.id]=aq;if(H){D[ar.id]=[]}aq[am]=H?function(){if(O[aq.readyState]){aq.timer=setTimeout(function(){f(ar,aq)},0)}}:function(at){if("load"===at.type){f(ar,aq)}};if(ap){aq[G]=function(){if(H){clearTimeout(aq.timer);delete aq.timer}f(ar,aq,V("module load failure"))}}aq.charset="utf-8";aq.type="text/javascript";aq.src=ar.url;l.appendChild(aq)}function f(au,ar,at){ar[am]="";if(ap){ar[G]=""}delete Q[au.id];if(at){au.reject(at)}else{var av,aq=D;if(H){aq=aq[au.id]}while(aq.length){av=aq.shift();av.push(au);X.apply(b,av)}if(H){delete aq[au.id]}if(!au.defined){au.defined=true;au.resolve()}}}function e(){}function o(ar){var aq=this;aq.config={};aq.urlBase="";aq.urlArgs="";aq.pathNow=ar||"";aq.pathMap={};aq.timeout=7}(e.prototype=o.prototype).clone=function(){var aq=new e();s(aq,this);return aq};function ag(ar){var at=this,aq=new n();at.resolve=aq.resolve;at.reject=aq.reject;at.promise=aq.promise;at.config=ar;at.rejected=false;at.requires={};at.exports=N;at.module=N}ag.prototype.getModule=function(aq,ar){var at=(ar?ar+"!":"")+aq;return ae[at]||(ae[at]=new P(at,aq,this.config))};function P(av,at,ar){var au=this,aq=new n();ar=ar.clone();ar.pathNow=at.replace(T,j);au.resolve=aq.resolve;au.reject=aq.reject;au.promise=aq.promise;au.context=new ag(ar);au.defined=false;au.padding=true;au.id=av;au.name=at;au.url=v(at,ar)}function S(aq){this.then=aq}S.prototype.always=function(aq){return this.then(aq,aq)};function n(){var ar=this,ax=new S(),au=[],at=[],aw="pending",av=function(aB,aA,az){var ay=ar;if(aB||aA){ay=new n();au.push(function(aC){aC.then(aB,aA).then(ay.resolve,ay.reject)})}if(A(az)){at.push(az)}return ay.promise},aq=function(aA){var az,ay;aA=d(aA);av=aA.then;for(az=0,ay=au.length;az<ay;az++){au[az](aA)}aq=au=N;return aA};ar.promise=ax;ar.then=ax.then=function(aA,az,ay){return av(aA,az,ay)};ar.resolve=function(ay){if(aq){aw="resolved";return aq(ay)}throw q()};ar.reject=function(ay){if(aq){aw="rejected";return aq(af(ay))}throw q()};ar.notify=function(aA){var az,ay;if(aq){for(az=0,ay=at.length;az<ay;az++){at[az](aA)}}throw q()};ar.state=function(){return aw}}function d(aq){if(aq instanceof S){return aq}else{return w(aq)}}function w(aq){return new S(function(at){try{return d(at?at(aq):aq)}catch(ar){return af(ar)}})}function af(aq){return new S(function(au,at){try{return at?d(at(aq)):af(aq)}catch(ar){return af(ar)}})}function ah(aq,au,at,ar){return d(aq).then(au,at,ar)}function v(at,ar,au){var aq=at;if(!L.test(aq)){aq+=(au||".js")}if(ar.urlBase&&!c.test(at)){aq=ar.urlBase+aq}if(ar.urlArgs){aq+=(an.test(aq)===-1?"?":"&")+ar.urlArgs}return aq}function B(ar){var at,au,aq;do{ar=ar.replace(x,j);aq=ar.indexOf(C)>-1}while(aq);do{at=ar.indexOf(F);if(aq=(0<at)){au=ar.lastIndexOf(j,at-1);ar=ar.slice(0,au<0?0:au)+ar.slice(at-ar.length+3)}}while(aq);return ar}function m(ar,aq){if(!ar){return ar}if(!c.test(ar)){if(!k.test(ar)){var av=aq.pathMap,aw=ar.split(j),at,au;for(at=aw.length;at>0;at--){au=aw.slice(0,at).join(j);if(au=av[au]){aw.splice(0,at,au);break}}ar=aw.join(j)}else{ar=aq.pathNow+ar}if(0===ar.indexOf("./")){ar=ar.substring(2)}}return B(ar)}function ao(at,ar){var aq=at?at.indexOf("!"):-1,au;if(-1!==aq){au=at.substring(0,aq);at=at.substring(aq+1,at.length)}else{at=m(at,ar)}if(au){au=m(au,ar)}return{prefix:au,name:at}}function u(){var aq;for(aq in Q){if(ab===O[Q[aq].readyState]){return ae[aq]}}}function z(av,ar){var at=[],ax=0,au,aw;while(-1<(ax=E.call(av,"require",ax))){if(N===au){au=String(ar).replace(I,"");aw=au.replace(ac,"$1").replace(U,"").split(ad)}au.replace(new RegExp(aw[ax]+ai,"g"),aq);ax++}return at;function aq(ay,aA,az){if(az){at.push(az)}return ay}}function h(ar,aq,ax){if(aq in al){return w(al[aq](ar)).then(az)}var au=ao(aq,ar.config),aw=au.prefix,at,aA,aB,ay;aq=au.name;if(N===aw){at=ar.getModule(aq);aB=at.promise;if(at.padding){aj(at)}}else{aA=new n();aB=aA.promise;if(aw){ay=ar.getModule(aw);ay.promise.then(function(aC){if(aC&&aC.load){if(aC.normalize){aq=aC.normalize(aq,function(aD){return m(aD,ar.config)})}else{aq=m(aq,ar.config)}at=ar.getModule(aq,aw);at.promise.then(aA.resolve,aA.reject);if(!at.ready){aC.load(aq,at.resolve,at.reject)}}else{aA.reject(V('"load" method undefined.'))}},aA.reject)}else{aA.reject(V("empty loader name."))}}return aB.then(az,av);function az(aC){return{index:ax,exports:aC}}function av(aC){if(!ar.rejected){ar.rejected=true;throw aC}}}function aa(at,av,aE){var ax=[],ay=true,aw=av.length,aC=false,aB,au,aA,aq;if(aE&&aE.length){av=av.concat(aE)}if(aA=au=av.length){ax.length=aw;for(aB=0;ay&&aB<au;aB++){if(aq=av[aB]){h(at,aq,aB<aw?aB:aq).then(aD,az)}}setTimeout(ar,1000*at.config.timeout)}else{at.resolve(ax)}return at.promise;function aD(aF){(t(aF.index)?at.requires:ax)[aF.index]=aF.exports;if(0===--aA&&!aC){aC=true;at.resolve(ax)}}function az(aF){ay=false;if(!aC){aC=true;at.reject(aF)}}function ar(){if(!aC){aC=true;at.reject(V("context timeout."))}}}function X(ar,aw,av,aq,au){var at=au.context;ar=m(ar,at.config);if(ar&&ar!==au.id){au=at.getModule(ar);at=au.context}if(au.defined){return}au.defined=true;au.padding=false;aa(at,aw,av).then(ay,ax);function ay(az){try{var aA=aq.apply(b,az)}catch(aB){au.reject(aB)}au.resolve(at.exports||aA)}function ax(az){au.reject(az)}}function W(aw,ay,au){var aq=arguments.length,ax=p,az,ar,av,at;if(2===aq){if(t(aw)){ar=aw}else{ax=aw}au=ay}else{if(1===aq){au=aw}else{if(3===aq){ar=aw;ax=ay}}}if(A(au)){if(p===ax&&!au.length){ax=""}ax=ax&&String(ax).replace(U,"");ax=ax?ax.split(ad):[];av=au;if(av.length){az=z(ax,av)}}else{ax=[];av=function(){return au}}if(H){at=u();D[at.id].push([ar,ax,az,av])}else{D.push([ar,ax,az,av])}}W.amd={version:"%VERSION%"};function g(aq,av,au){aq=String(aq).replace(U,"").split(ad);var ar=new ag(M),at;if(A(av)){at=z(aq,av)}else{av=N}return aa(ar,aq,at).then(function(aw){return av&&av.apply(b,aw)},au)}g.config=function(ar){if(ar){var aq=ar.urlBase;if(aq&&!R.test(aq)){ar.urlBase+="/"}s(M,ar)}return M};function Y(aq){return function(ar){return aq.requires[ar]}}function J(aq){return aq.exports||(aq.exports={})}function y(aq){return aq.module||(aq.module={exports:J(aq),toUrl:function(au,at){at=at||aq.config;var ar=au.lastIndexOf("."),av="";if(-1!==ar){au=au.substring(0,ar);av=au.substring(ar,au.length)}au=m(au,at);return v(au,at,av)}})}al.require=Y;al.exports=J;al.module=y;al.Promise=function(){return S};al.Deferred=function(){return n};S.resolve=d;S.resolved=w;S.rejected=af;S.when=ah;b.define=W;b.require=g}(this));
