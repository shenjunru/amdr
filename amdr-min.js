/*!
 * AMDR <Asynchronous Module Define & Require>
 * (c) 2012 Shen Junru. MIT License.
 * http://github.com/xfsn/amdr
 */
(function(b,u,P){var i=b.document,l=an("head")||an("script"),a=i.createElement("script"),ap="onload",I="onerror",y=ap in a,aa=I in a,J=!y,ae={},Q={interactive:ae,loaded:1,complete:1},S={},ao={},ah={},G=J?{}:[],O=new o(),ag=/\s*,\s*/g,W=/^\s+|\s+$/g,af=/^\S+(?:\s*|\s+\S+\s*)\(([^\)]*)\)[\s\S]+$/,K=/\/\*([\s\S]*?)\*\/|\/\/(.*)$/mg,al=/\s*\((['"])([^'"\(]+)\1\)/.source,c=/^\/|^[^:]+:\/\//,k=/^\.?\.\//,N=/\?|\.js$/,A=/\/\.\//g,V=/\/?[^\/]*$/,T=/\/$/,aq=/\?/,F="/./",z="..",j="/",p="require,exports,module",r=Object.prototype.hasOwnProperty,H=Array.prototype.indexOf||function(at,av){var au=this.length;av=av?(av<0?Math.max(0,au+av):av):0;for(;av<au;av++){if(av in this&&at===this[av]){return av}}return -1};if(J){ap="onreadystatechange"}J=u||J;function M(at){return at instanceof Array}function D(at){return"function"===typeof at}function t(at){return"string"===typeof at}function ac(at){return"object"===typeof at}function s(aw,av){if(av){var at,au;for(at in av){if(r.call(av,at)){au=av[at];if(M(au)){au=au.concat()}else{if(ac(au)){au=s(s({},aw[at]),au)}}aw[at]=au}}}return aw}function X(at){return new Error(at)}function q(){return X("already fulfilled")}function an(at){return i.getElementsByTagName(at)[0]}function am(au){var at=i.createElement("script");au.padding=false;S[au.id]=at;if(J){G[au.id]=[]}at[ap]=y?function(av){if("load"===av.type){f(au,at)}}:function(){if(Q[at.readyState]){f(au,at)}};if(aa){at[I]=function(){f(au,at,X("module load failure"))}}at.charset="utf-8";at.async=at.defer=true;at.type="text/javascript";at.src=au.url;l.appendChild(at)}function f(aw,au,av){au[ap]="";if(aa){au[I]=""}delete S[aw.id];if(av){aw.reject(av)}else{var ax,at=G;if(J){at=at[aw.id]}while(at.length){ax=at.shift();ax.push(aw);Z.apply(b,ax)}if(J){delete at[aw.id]}if(!aw.defined){aw.defined=true;aw.resolve()}}}function e(){}function o(au){var at=this;at.config={};at.urlBase="";at.urlArgs="";at.pathNow=au||"";at.pathMap={};at.timeout=7}(e.prototype=o.prototype).clone=function(){var at=new e();s(at,this);return at};function aj(au){var av=this,at=new n();av.resolve=at.resolve;av.reject=at.reject;av.promise=at.promise;av.config=au;av.rejected=false;av.requires={};av.exports=P;av.module=P}aj.prototype.getModule=function(at,au){var av=(au?au+"!":"")+at;return ah[av]||(ah[av]=new R(av,at,this.config))};function R(ax,av,au){var aw=this,at=new n();au=au.clone();au.pathNow=av.replace(V,j);aw.resolve=at.resolve;aw.reject=at.reject;aw.promise=at.promise;aw.context=new aj(au);aw.defined=false;aw.padding=true;aw.id=ax;aw.name=av;aw.url=w(av,au)}function U(at){this.then=at}U.prototype.always=function(at){return this.then(at,at)};function n(){var au=this,az=new U(),aw=[],av=[],ay="pending",ax=function(aD,aC,aB){var aA=au;if(aD||aC){aA=new n();aw.push(function(aE){aE.then(aD,aC).then(aA.resolve,aA.reject)})}if(D(aB)){av.push(aB)}return aA.promise},at=function(aC){var aB,aA;aC=d(aC);ax=aC.then;for(aB=0,aA=aw.length;aB<aA;aB++){aw[aB](aC)}at=aw=P;return aC};au.promise=az;au.then=az.then=function(aC,aB,aA){return ax(aC,aB,aA)};au.resolve=function(aA){if(at){ay="resolved";return at(aA)}throw q()};au.reject=function(aA){if(at){ay="rejected";return at(ai(aA))}throw q()};au.notify=function(aC){var aB,aA;if(at){for(aB=0,aA=av.length;aB<aA;aB++){av[aB](aC)}}throw q()};au.state=function(){return ay}}function d(at){if(at instanceof U){return at}else{return x(at)}}function x(at){return new U(function(av){try{return d(av?av(at):at)}catch(au){return ai(au)}})}function ai(at){return new U(function(aw,av){try{return av?d(av(at)):ai(at)}catch(au){return ai(au)}})}function ak(at,aw,av,au){return d(at).then(aw,av,au)}function w(av,au,aw){var at=av;if(!N.test(at)){at+=(aw||".js")}if(au.urlBase&&!c.test(av)){at=au.urlBase+at}if(au.urlArgs){at+=(aq.test(at)===-1?"?":"&")+au.urlArgs}return at}function E(at){do{at=at.replace(A,j)}while(at.indexOf(F)>-1);var au,av=at.split(j);while(0<(au=H.call(av,z,1))){av.splice(au-1,2)}return at=av.join(j)}function m(au,at){if(!au){return au}if(!c.test(au)){if(!k.test(au)){var ax=at.pathMap,ay=au.split(j),av,aw;for(av=ay.length;av>0;av--){aw=ay.slice(0,av).join(j);if(r.call(ax,aw)){if(aw=ax[aw]){ay.splice(0,av,aw)}else{ay.splice(0,av)}break}}au=ay.join(j)}else{au=at.pathNow+au}if(0===au.indexOf("./")){au=au.substring(2)}}return E(au)}function ar(av,au){var at=av?av.indexOf("!"):-1,aw;if(-1!==at){aw=av.substring(0,at);av=av.substring(at+1,av.length)}else{av=m(av,au)}if(aw){aw=m(aw,au)}return{prefix:aw,name:av}}function v(){var at;for(at in S){if(ae===Q[S[at].readyState]){return ah[at]}}}function C(ax,au){var av=[],az=0,aw,ay;while(-1<(az=H.call(ax,"require",az))){if(P===aw){aw=String(au).replace(K,"");ay=aw.replace(af,"$1").replace(W,"").split(ag)}aw.replace(new RegExp(ay[az]+al,"g"),at);az++}return av;function at(aA,aC,aB){if(aB){av.push(aB)}return aA}}function h(au,at,az){if(at in ao){return x(ao[at](au)).then(aB)}var aw=ar(at,au.config),ay=aw.prefix,av,aC,aD,aA;at=aw.name;if(P===ay){av=au.getModule(at);aD=av.promise;if(av.padding){am(av)}}else{aC=new n();aD=aC.promise;if(ay){aA=au.getModule(ay);aA.promise.then(function(aE){if(aE&&aE.load){if(aE.normalize){at=aE.normalize(at,function(aF){return m(aF,au.config)})}else{at=m(at,au.config)}av=au.getModule(at,ay);av.promise.then(aC.resolve,aC.reject);if(!av.ready){aE.load(at,av.resolve,av.reject)}}else{aC.reject(X('"load" method undefined.'))}},aC.reject)}else{aC.reject(X("empty loader name."))}}return aD.then(aB,ax);function aB(aE){return{index:az,exports:aE}}function ax(aE){if(!au.rejected){au.rejected=true;throw aE}}}function ad(av,ax,aG){var az=[],aA=true,ay=ax.length,aE=false,aD,aw,aC,at;if(aG&&aG.length){ax=ax.concat(aG)}if(aC=aw=ax.length){az.length=ay;for(aD=0;aA&&aD<aw;aD++){if(at=ax[aD]){h(av,at,aD<ay?aD:at).then(aF,aB)}}setTimeout(au,1000*av.config.timeout)}else{av.resolve(az)}return av.promise;function aF(aH){(t(aH.index)?av.requires:az)[aH.index]=aH.exports;if(0===--aC&&!aE){aE=true;av.resolve(az)}}function aB(aH){aA=false;if(!aE){aE=true;av.reject(aH)}}function au(){if(!aE){aE=true;av.reject(X("context timeout."))}}}function Z(au,ay,ax,at,aw){var av=aw.context;au=m(au,av.config);if(au&&au!==aw.id){aw=av.getModule(au);av=aw.context}if(aw.defined){return}aw.defined=true;aw.padding=false;ad(av,ay,ax).then(aA,az);function aA(aB){try{var aC=at.apply(b,aB)}catch(aD){aw.reject(aD)}aw.resolve(av.exports||aC)}function az(aB){aw.reject(aB)}}function Y(ay,aA,aw){var at=arguments.length,az=p,aB,au,ax,av;if(2===at){if(t(ay)){au=ay}else{az=ay}aw=aA}else{if(1===at){aw=ay}else{if(3===at){au=ay;az=aA}}}if(D(aw)){if(p===az&&!aw.length){az=""}az=az&&String(az).replace(W,"");az=az?az.split(ag):[];ax=aw;if(ax.length){aB=C(az,ax)}}else{az=[];ax=function(){return aw}}if(J){av=v();G[av.id].push([au,az,aB,ax])}else{G.push([au,az,aB,ax])}}Y.amd={version:"%VERSION%"};function g(at,ax,aw){at=String(at).replace(W,"").split(ag);var au=new aj(O),av;if(D(ax)){av=C(at,ax)}else{ax=P}return ad(au,at,av).then(function(ay){return ax&&ax.apply(b,ay)},aw)}g.config=function(au){if(au){var at=au.urlBase,aw=au.pathMap,av,ax;if(at&&!T.test(at)){au.urlBase+="/"}if(aw){for(av in aw){aw[av]=E(aw[av].replace(T,""))}}s(O,au)}return O};function ab(at){return function(au){return at.requires[au]}}function L(at){return at.exports||(at.exports={})}function B(at){return at.module||(at.module={exports:L(at),config:function(){return at.config.config},toUrl:function(aw,av){av=av||at.config;var au=aw.lastIndexOf("."),ax="";if(-1!==au){aw=aw.substring(0,au);ax=aw.substring(au,aw.length)}aw=m(aw,av);return w(aw,av,ax)}})}ao.require=ab;ao.exports=L;ao.module=B;ao.isIE=function(){return u};ao.Promise=function(){return U};ao.Deferred=function(){return n};U.resolve=d;U.resolved=x;U.rejected=ai;U.when=ak;b.define=Y;b.require=g}(this,/*@cc_on!@*/!1));
